x=0.05,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=5)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=5)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=5)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 4 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=5)))
grob5 <- grobTree(textGrob(paste0("No. of Genes with 5 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.70, hjust=0, gp=gpar(col="black", fontsize=5)))
grob6 <- grobTree(textGrob(paste0("No. of Genes with 6 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.65, hjust=0, gp=gpar(col="black", fontsize=5)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram() + labs(title=cell_type)
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob5) + annotation_custom(grob6) + annotation_custom(grob0)
count <- count + 1
}
for (cell_type in cell_types){
zeros_frequency <- count(df_list[[cell_type]]$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero) :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.05,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=5)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero) :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=5)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=5)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=5)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 4 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=5)))
grob5 <- grobTree(textGrob(paste0("No. of Genes with 5 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.70, hjust=0, gp=gpar(col="black", fontsize=5)))
grob6 <- grobTree(textGrob(paste0("No. of Genes with 6 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.65, hjust=0, gp=gpar(col="black", fontsize=5)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram() + labs(title=cell_type)  +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob5) + annotation_custom(grob6) + annotation_custom(grob0)
count <- count + 1
}
#do.call(grid.arrange,p, nrow=2)
#p <- p + theme(legend.position = "top")
#g <- grid.arrange(grobs = p, ncol = 3, )
g <- ggarrange(plotlist = p, nrow=2, ncol = 3, common.legend = TRUE, legend="bottom")
p     <- list()
count <- 1
for (cell_type in cell_types){
zeros_frequency <- count(df_list[[cell_type]]$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero) :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.05,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=5)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero) :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=5)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=5)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=5)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 4 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=5)))
grob5 <- grobTree(textGrob(paste0("No. of Genes with 5 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.70, hjust=0, gp=gpar(col="black", fontsize=5)))
grob6 <- grobTree(textGrob(paste0("No. of Genes with 6 samples zero) :", zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.05,  y=0.65, hjust=0, gp=gpar(col="black", fontsize=5)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram() + labs(title=cell_type)  +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob5) + annotation_custom(grob6) + annotation_custom(grob0)
count <- count + 1
}
#do.call(grid.arrange,p, nrow=2)
#p <- p + theme(legend.position = "top")
#g <- grid.arrange(grobs = p, ncol = 3, )
g <- ggarrange(plotlist = p, nrow=2, ncol = 3, common.legend = TRUE, legend="bottom")
ggsave(filename = "Cell type wise zeros.jpg", plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
p     <- list()
count <- 1
for (cell_type in cell_types){
zeros_frequency <- count(df_list[[cell_type]]$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero) :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.5,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=5)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero) :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.5,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=5)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero) :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.5,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=5)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero) :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.5,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=5)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 4 samples zero) :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.5,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=5)))
grob5 <- grobTree(textGrob(paste0("No. of Genes with 5 samples zero) :", zeros_frequency[zeros_frequency$x == 5,]$freq),
x=0.5,  y=0.70, hjust=0, gp=gpar(col="black", fontsize=5)))
grob6 <- grobTree(textGrob(paste0("No. of Genes with 6 samples zero) :", zeros_frequency[zeros_frequency$x == 6,]$freq),
x=0.5,  y=0.65, hjust=0, gp=gpar(col="black", fontsize=5)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram() + labs(title=cell_type)  +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob5) + annotation_custom(grob6) + annotation_custom(grob0)
count <- count + 1
}
#do.call(grid.arrange,p, nrow=2)
#p <- p + theme(legend.position = "top")
#g <- grid.arrange(grobs = p, ncol = 3, )
g <- ggarrange(plotlist = p, nrow=2, ncol = 3, common.legend = TRUE, legend="bottom")
ggsave(filename = "Cell type wise zeros.jpg", plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
p     <- list()
count <- 1
for (cell_type in cell_types){
zeros_frequency <- count(df_list[[cell_type]]$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero) :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.5,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero) :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.5,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero) :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.5,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero) :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.5,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 4 samples zero) :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.5,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=10)))
grob5 <- grobTree(textGrob(paste0("No. of Genes with 5 samples zero) :", zeros_frequency[zeros_frequency$x == 5,]$freq),
x=0.5,  y=0.70, hjust=0, gp=gpar(col="black", fontsize=10)))
grob6 <- grobTree(textGrob(paste0("No. of Genes with 6 samples zero) :", zeros_frequency[zeros_frequency$x == 6,]$freq),
x=0.5,  y=0.65, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram() + labs(title=cell_type)  +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob5) + annotation_custom(grob6) + annotation_custom(grob0)
count <- count + 1
}
#do.call(grid.arrange,p, nrow=2)
#p <- p + theme(legend.position = "top")
#g <- grid.arrange(grobs = p, ncol = 3, )
g <- ggarrange(plotlist = p, nrow=2, ncol = 3, common.legend = TRUE, legend="bottom")
ggsave(filename = "Cell type wise zeros.jpg", plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
p     <- list()
count <- 1
for (cell_type in cell_types){
zeros_frequency <- count(df_list[[cell_type]]$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero) :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.25,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero) :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.25,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero) :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.25,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero) :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 4 samples zero) :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.25,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=10)))
grob5 <- grobTree(textGrob(paste0("No. of Genes with 5 samples zero) :", zeros_frequency[zeros_frequency$x == 5,]$freq),
x=0.25,  y=0.70, hjust=0, gp=gpar(col="black", fontsize=10)))
grob6 <- grobTree(textGrob(paste0("No. of Genes with 6 samples zero) :", zeros_frequency[zeros_frequency$x == 6,]$freq),
x=0.25,  y=0.65, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram() + labs(title=cell_type)  +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob5) + annotation_custom(grob6) + annotation_custom(grob0)
count <- count + 1
}
#do.call(grid.arrange,p, nrow=2)
#p <- p + theme(legend.position = "top")
#g <- grid.arrange(grobs = p, ncol = 3, )
g <- ggarrange(plotlist = p, nrow=2, ncol = 3, common.legend = TRUE, legend="bottom")
ggsave(filename = "Cell type wise zeros.jpg", plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
p     <- list()
count <- 1
for (cell_type in cell_types){
zeros_frequency <- count(df_list[[cell_type]]$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.25,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.25,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.25,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 4 samples zero :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.25,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=10)))
grob5 <- grobTree(textGrob(paste0("No. of Genes with 5 samples zero :", zeros_frequency[zeros_frequency$x == 5,]$freq),
x=0.25,  y=0.70, hjust=0, gp=gpar(col="black", fontsize=10)))
grob6 <- grobTree(textGrob(paste0("No. of Genes with 6 samples zero :", zeros_frequency[zeros_frequency$x == 6,]$freq),
x=0.25,  y=0.65, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram() + labs(title=cell_type)  +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob5) + annotation_custom(grob6) + annotation_custom(grob0)
count <- count + 1
}
#do.call(grid.arrange,p, nrow=2)
#p <- p + theme(legend.position = "top")
#g <- grid.arrange(grobs = p, ncol = 3, )
g <- ggarrange(plotlist = p, nrow=2, ncol = 3, common.legend = TRUE, legend="bottom")
ggsave(filename = "Cell type wise zeros.jpg", plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
df_list
df_list[["Astro"]]
colnames(df_list[["Astro"]])
a <- colnames(df_list[["Astro"]])
a
a[grepl("chimp", a, fixed = TRUE)]
for (cell_type in cell_types){}
for (primate in species){}
primate_df <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate
species
primate_list <- c("chimp", "macaque", "human")
for (primate in primate_list){}
primate_df <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df
dim(primate_df)
primate_df      <- rowSums(primate_df == 0)
zeros_frequency <- count(primate_df$Zeros)
primate_df      <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df      <- rowSums(primate_df == 0)
zeros_frequency <- count(primate_df$Zeros)
primate_df       <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df$Zeros <- rowSums(primate_df == 0)
zeros_frequency  <- count(primate_df$Zeros)
zeros_frequency
primate_list <- c("chimp", "macaque", "human")
for (cell_type in cell_types){
p     <- list()
count <- 1
for (primate in primate_list){
primate_df       <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df$Zeros <- rowSums(primate_df == 0)
zeros_frequency  <- count(primate_df$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.25,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.25,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.25,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram()         + labs(title=cell_type)    +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob0)
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=2, ncol = 3, common.legend = TRUE, legend="bottom")
ggsave(filename = paste0(primate, "zeros.jpg"), plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
}
for (cell_type in cell_types){
p     <- list()
count <- 1
for (primate in primate_list){
primate_df       <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df$Zeros <- rowSums(primate_df == 0)
zeros_frequency  <- count(primate_df$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.25,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.25,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.25,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram()         + labs(title=cell_type)    +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob0)
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=2, ncol = 3, common.legend = TRUE, legend="bottom")
print(paste0(primate, "zeros.jpg"))
ggsave(filename = paste0(primate, "zeros.jpg"), plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
}
for (cell_type in cell_types){
p     <- list()
count <- 1
for (primate in primate_list){
primate_df       <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df$Zeros <- rowSums(primate_df == 0)
zeros_frequency  <- count(primate_df$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.25,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.25,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.25,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram()         + labs(title=cell_type)    +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob0)
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=1, ncol = 3, common.legend = TRUE, legend="bottom")
print(paste0(primate, "zeros.jpg"))
ggsave(filename = paste0(cell_type, "zeros.jpg"), plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
}
for (cell_type in cell_types){
p     <- list()
count <- 1
for (primate in primate_list){
primate_df       <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df$Zeros <- rowSums(primate_df == 0)
zeros_frequency  <- count(primate_df$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.25,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.25,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.25,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram()         + labs(title=primate)    +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob0)
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=1, ncol = 3, common.legend = TRUE, legend="bottom")
ggsave(filename = paste0(cell_type, "zeros.jpg"), plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
}
for (cell_type in cell_types){
p     <- list()
count <- 1
for (primate in primate_list){
primate_df       <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df$Zeros <- rowSums(primate_df == 0)
zeros_frequency  <- count(primate_df$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.25,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.25,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.25,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.25,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram()         + labs(title=primate)    +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob0)
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=1, ncol = 3, common.legend = TRUE, legend="bottom")
ggsave(filename = paste0(cell_type, "_zeros.jpg"), plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
}
for (cell_type in cell_types){
p     <- list()
count <- 1
for (primate in primate_list){
primate_df       <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df$Zeros <- rowSums(primate_df == 0)
zeros_frequency  <- count(primate_df$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.25,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.25,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.25,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.25,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram()         + labs(title=primate)    +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob0)
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=1, ncol = 3, common.legend = TRUE, legend="bottom")
g <- annotate_figure(g, top = text_grob(cell_type))
ggsave(filename = paste0(cell_type, "_zeros.jpg"), plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
}
for (cell_type in cell_types){
p     <- list()
count <- 1
for (primate in primate_list){
primate_df       <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df$Zeros <- rowSums(primate_df == 0)
zeros_frequency  <- count(primate_df$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.25,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.25,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.25,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 4 samples zero :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.25,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram()         + labs(title=primate)    +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob0)
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=1, ncol = 3, common.legend = TRUE, legend="bottom")
g <- annotate_figure(g, top = text_grob(cell_type))
ggsave(filename = paste0(cell_type, "_zeros.jpg"), plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
}
for (cell_type in cell_types){
p     <- list()
count <- 1
for (primate in primate_list){
primate_df       <- df_list[[cell_type]][grepl(primate, colnames(df_list[[cell_type]]), fixed = TRUE)]
primate_df$Zeros <- rowSums(primate_df == 0)
zeros_frequency  <- count(primate_df$Zeros)
grob0 <- grobTree(textGrob(paste0("No. of Genes with 0 samples zero :", zeros_frequency[zeros_frequency$x == 0,]$freq),
x=0.25,  y=0.95, hjust=0, gp=gpar(col="black", fontsize=10)))
grob1 <- grobTree(textGrob(paste0("No. of Genes with 1 sample zero :",  zeros_frequency[zeros_frequency$x == 1,]$freq),
x=0.25,  y=0.90, hjust=0, gp=gpar(col="black", fontsize=10)))
grob2 <- grobTree(textGrob(paste0("No. of Genes with 2 samples zero :", zeros_frequency[zeros_frequency$x == 2,]$freq),
x=0.25,  y=0.85, hjust=0, gp=gpar(col="black", fontsize=10)))
grob3 <- grobTree(textGrob(paste0("No. of Genes with 3 samples zero :", zeros_frequency[zeros_frequency$x == 3,]$freq),
x=0.25,  y=0.80, hjust=0, gp=gpar(col="black", fontsize=10)))
grob4 <- grobTree(textGrob(paste0("No. of Genes with 4 samples zero :", zeros_frequency[zeros_frequency$x == 4,]$freq),
x=0.25,  y=0.75, hjust=0, gp=gpar(col="black", fontsize=10)))
p[[count]] <- ggplot(df_list[[cell_type]], aes(x=Zeros)) + geom_histogram()         + labs(title=primate)    +
annotation_custom(grob1) + annotation_custom(grob2) + annotation_custom(grob3) +
annotation_custom(grob4) + annotation_custom(grob0)
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=1, ncol = 3, common.legend = TRUE, legend="bottom")
g <- annotate_figure(g, top = text_grob(cell_type))
ggsave(filename = paste0("Sample_zeros_test_results/", cell_type, "_zeros.jpg"), plot = g, device = "jpeg",
width=14.4, height=9, dpi=300)
}
res
setwd("D:/Yi/Evolution Paper/Metadata generator files/Kanton et. al")
suppressMessages(suppressWarnings(library(Seurat)))
suppressMessages(suppressWarnings(library(hash)))
suppressMessages(suppressWarnings(library(readxl)))
suppressMessages(suppressWarnings(library(plyr)))
metadata_file <- read_excel("author_source/metadata_file.xlsx")
traditional_cell_types <- c("Excite", "Astrocyte", "Inhibit", "Microglia", "Oligo", "OPC")
study_cell_names       <- c("Ex",  "Ast", "In",  "Mic", "Oli", "OPC")
study_name_to_local_name_hash <- hash(study_cell_names, traditional_cell_types)
# TRADITIONAL CELL TYPES
metadata_file <- metadata_file[metadata_file$`Cell class` %in% study_cell_names,]
local_cell_name_vector <- c()
for (cell in metadata_file$`Cell class`){
local_cell_name_vector <- c(local_cell_name_vector,
study_name_to_local_name_hash[[cell]])
}
metadata_file$local_name <- local_cell_name_vector
#metadata_file <- readRDS("D:/Yi/SPRING 2023/Evolution/Kanton et. al/subselected_metadata_file_with_local_names.rds")
metadata_file[metadata_file$Species == "human",]$Barcode <- paste0(metadata_file[metadata_file$Species == "human",]$Barcode, "H")
metadata_file[metadata_file$Species == "chimp",]$Barcode <- paste0(metadata_file[metadata_file$Species == "chimp",]$Barcode, "C")
metadata_file[metadata_file$Species == "macaque",]$Barcode <- paste0(metadata_file[metadata_file$Species == "macaque",]$Barcode, "M")
metadata_file[metadata_file$Species == "human",]$local_name <- paste0(metadata_file[metadata_file$Species == "human",]$local_name, "_#human")
metadata_file[metadata_file$Species == "chimp",]$local_name <- paste0(metadata_file[metadata_file$Species == "chimp",]$local_name, "_#chimp")
metadata_file[metadata_file$Species == "macaque",]$local_name <- paste0(metadata_file[metadata_file$Species == "macaque",]$local_name, "_#macaque")
metadata_file <- metadata_file[metadata_file$Individual != "BA1",]
#saveRDS(metadata_file, "final_metadata_file.rds")
df_human_macak           <- data.frame(metadata_file[metadata_file$Species %in% c("human", "macaque"),
c("Barcode", "local_name", "Individual")])
duplicated_barcodes      <- df_human_macak$Barcode[duplicated(df_human_macak$Barcode)]
df_human_macak           <- df_human_macak[df_human_macak$Barcode %in% duplicated_barcodes == FALSE,]
rownames(df_human_macak) <- df_human_macak$Barcode
df_human_macak           <- df_human_macak[-c(1)]
df_human_macak$local_name <- as.factor(df_human_macak$local_name)
df_human_macak$Individual <- as.factor(df_human_macak$Individual)
df_human_chimp           <- data.frame(metadata_file[metadata_file$Species %in% c("human", "chimp"),
c("Barcode", "local_name", "Individual")])
duplicated_barcodes      <- df_human_chimp$Barcode[duplicated(df_human_chimp$Barcode)]
df_human_chimp           <- df_human_chimp[df_human_chimp$Barcode %in% duplicated_barcodes == FALSE,]
rownames(df_human_chimp) <- df_human_chimp$Barcode
df_human_chimp           <- df_human_chimp[-c(1)]
df_human_chimp$local_name <- as.factor(df_human_chimp$local_name)
df_human_chimp$Individual <- as.factor(df_human_chimp$Individual)
df_chimp_macak           <- data.frame(metadata_file[metadata_file$Species %in% c("macaque", "chimp"),
c("Barcode", "local_name", "Individual")])
duplicated_barcodes      <- df_chimp_macak$Barcode[duplicated(df_chimp_macak$Barcode)]
df_chimp_macak           <- df_chimp_macak[df_chimp_macak$Barcode %in% duplicated_barcodes == FALSE,]
rownames(df_chimp_macak) <- df_chimp_macak$Barcode
df_chimp_macak           <- df_chimp_macak[-c(1)]
df_chimp_macak$local_name <- as.factor(df_chimp_macak$local_name)
df_chimp_macak$Individual <- as.factor(df_chimp_macak$Individual)
sample_to_gender <- hash(c(3, "CHD2", "MI1", "MG2", "MH1", "HC1", "HG1", "HE1"),
c("M", "F"   ,  "M" , "M"  , "M"  , "F"  , "M"  , "M"))
sample_to_age <- hash(c(3, "CHD2", "MI1", "MG2", "MH1", "HC1", "HG1", "HE1"),
c(round(2.06871*12 - 2.30729, 1) ,  round(2.06871*45 - 2.30729, 1),
round(3.05864*9 + 0.47236, 1)  ,  round(3.05864*7 + 0.47236, 1) , round(3.05864*9 + 0.47236, 1),
34                             ,                           54   ,  17))
df_chimp_macak_sex_vector <- c()
df_human_chimp_sex_vector <- c()
df_human_macak_sex_vector <- c()
df_chimp_macak_age_vector <- c()
df_human_chimp_age_vector <- c()
df_human_macak_age_vector <- c()
for (sample_id in df_chimp_macak$Individual){
df_chimp_macak_sex_vector <- c(df_chimp_macak_sex_vector, sample_to_gender[[sample_id]])
df_chimp_macak_age_vector <- c(df_chimp_macak_age_vector, sample_to_age[[sample_id]])
}
for (sample_id in df_human_chimp$Individual){
df_human_chimp_sex_vector <- c(df_human_chimp_sex_vector, sample_to_gender[[sample_id]])
df_human_chimp_age_vector <- c(df_human_chimp_age_vector, sample_to_age[[sample_id]])
}
for (sample_id in df_human_macak$Individual){
df_human_macak_sex_vector <- c(df_human_macak_sex_vector, sample_to_gender[[sample_id]])
df_human_macak_age_vector <- c(df_human_macak_age_vector, sample_to_age[[sample_id]])
}
df_human_chimp$human_age <- df_human_chimp_age_vector
df_human_chimp$sex       <- as.factor(df_human_chimp_sex_vector)
df_chimp_macak$human_age <- df_chimp_macak_age_vector
df_chimp_macak$sex       <- as.factor(df_chimp_macak_sex_vector)
df_human_macak$human_age <- df_human_macak_age_vector
df_human_macak$sex       <- as.factor(df_human_macak_sex_vector)
colnames(df_chimp_macak)         <- c("trad", "sample_id", "human_age",  "sex")
colnames(df_human_chimp)         <- c("trad", "sample_id", "human_age",  "sex")
colnames(df_human_macak)         <- c("trad", "sample_id", "human_age",  "sex")
df_chimp_macak
metadata_file
metadata_file$Segment
