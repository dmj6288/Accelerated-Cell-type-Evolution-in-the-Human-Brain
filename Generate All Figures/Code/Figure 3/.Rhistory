add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}
results <- results %>% mutate(Region = if_else(Study == "Caglayan", "PCC", "dlPFC"))
results$Cell_Region <- paste0(results$Cell, " ", results$Region)
results <- results %>% add_xy_position(x = "Cell")
heatmap_table <- rbind(heatmap_table, results[, c("Cell", "Study", ".y.", "p")])
stats_results_list[[col]]      <- results
data_stats_results_list[[col]] <- current_data
}
formula
HEAD(current_data)
head(current_data)
#test_cols <- colnames(data)[c(2, 3, 8, 10, 11, 12, 14, 16, 36, 37)]
test_cols <- colnames(data)[c(2, 3, 4, 9, 11, 12, 13, 15, 17, 37, 38)]
stats_results_list      <- list()
data_stats_results_list <- list()
heatmap_table           <- c()
for (col in test_cols){
formula_str <- paste0(col, " ~ DEG")
formula <- as.formula(formula_str)
print(col)
if (col == "HAR_Count" || col == "cHAR_Count" || col == "HAQER_Count" || col == "tandem_Count" || col == "dNdS" || col == "Alpha" || col == "specificity_values"){
print("A")
current_data <- na.omit(data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Cell_Region", "Region", "Expression")])
# Step 1: Calculate p-values for each group
results <- current_data %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}else{
if (col == "Human_hypo" || col == "Human_UP"){
reg_test_col <- "UR_test"
formula_str <- paste0(col, " ~ UR_test")
print("B1")
}else{
reg_test_col <- "DR_test"
formula_str <- paste0(col, " ~ DR_test")
print("B2")
}
formula <- as.formula(formula_str)
current_data <- data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Regulation", "Cell_Region", "Region", "Expression", reg_test_col)]
current_data <- current_data[!duplicated(current_data), ]
# Step 1: Calculate p-values for each group
results <- current_data %>%
group_by(Cell, Species, Study, Regulation) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}
results <- results %>% mutate(Region = if_else(Study == "Caglayan", "PCC", "dlPFC"))
results$Cell_Region <- paste0(results$Cell, " ", results$Region)
results <- results %>% add_xy_position(x = "Cell")
heatmap_table <- rbind(heatmap_table, results[, c("Cell", "Study", ".y.", "p")])
stats_results_list[[col]]      <- results
data_stats_results_list[[col]] <- current_data
}
# Step 1: Calculate p-values for each group
results <- current_data %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
#test_cols <- colnames(data)[c(2, 3, 8, 10, 11, 12, 14, 16, 36, 37)]
test_cols <- colnames(data)[c(2, 3, 4, 9, 11, 12, 13, 15, 17, 37, 38)]
stats_results_list      <- list()
data_stats_results_list <- list()
heatmap_table           <- c()
for (col in test_cols){
formula_str <- paste0(col, " ~ DEG")
formula <- as.formula(formula_str)
print(col)
if (col == "HAR_Count" || col == "cHAR_Count" || col == "HAQER_Count" || col == "tandem_Count" || col == "dNdS" || col == "Alpha" || col == "specificity_values"){
print("A")
current_data <- na.omit(data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Cell_Region", "Region", "Expression")])
# Step 1: Calculate p-values for each group
results <- current_data %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}else{
if (col == "Human_hypo" || col == "Human_UP"){
reg_test_col <- "UR_test"
formula_str <- paste0(col, " ~ UR_test")
print("B1")
}else{
reg_test_col <- "DR_test"
formula_str <- paste0(col, " ~ DR_test")
print("B2")
}
formula <- as.formula(formula_str)
current_data <- data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Regulation", "Cell_Region", "Region", "Expression", reg_test_col)]
current_data <- current_data[!duplicated(current_data), ]
# Step 1: Calculate p-values for each group
results <- current_data %>%
group_by(Cell, Species, Study, Regulation) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}
results <- results %>% mutate(Region = if_else(Study == "Caglayan", "PCC", "dlPFC"))
results$Cell_Region <- paste0(results$Cell, " ", results$Region)
# results <- results %>% add_xy_position(x = "Cell")
heatmap_table <- rbind(heatmap_table, results[, c("Cell", "Study", ".y.", "p")])
stats_results_list[[col]]      <- results
data_stats_results_list[[col]] <- current_data
}
current_data
formula
formula <- as.formula(formula_str)
current_data <- data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Regulation", "Cell_Region", "Region", "Expression", reg_test_col)]
current_data <- current_data[!duplicated(current_data), ]
# Step 1: Calculate p-values for each group
results <- current_data %>%
group_by(Cell, Species, Study, Regulation) %>%
wilcox_test(formula)
formula
#test_cols <- colnames(data)[c(2, 3, 8, 10, 11, 12, 14, 16, 36, 37)]
test_cols <- colnames(data)[c(2, 3, 4, 9, 11, 12, 13, 15, 17, 37, 38)]
stats_results_list      <- list()
data_stats_results_list <- list()
heatmap_table           <- c()
for (col in test_cols){
formula_str <- paste0(col, " ~ DEG")
formula <- as.formula(formula_str)
print(col)
if (col == "HAR_Count" || col == "cHAR_Count" || col == "HAQER_Count" || col == "tandem_Count" || col == "dNdS" || col == "Alpha" || col == "specificity_values"){
print("A")
current_data <- na.omit(data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Cell_Region", "Region", "Expression")])
# Step 1: Calculate p-values for each group
results <- current_data %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}else{
if (col == "Human_hypo" || col == "Human_UP"){
reg_test_col <- "UR_test"
formula_str <- paste0(col, " ~ UR_test")
print("B1")
}else{
reg_test_col <- "DR_test"
formula_str <- paste0(col, " ~ DR_test")
print("B2")
}
formula <- as.formula(formula_str)
current_data <- data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Regulation", "Cell_Region", "Region", "Expression", reg_test_col)]
current_data <- current_data[!duplicated(current_data), ]
# Step 1: Calculate p-values for each group
results <- current_data          %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}
results <- results %>% mutate(Region = if_else(Study == "Caglayan", "PCC", "dlPFC"))
results$Cell_Region <- paste0(results$Cell, " ", results$Region)
# results <- results %>% add_xy_position(x = "Cell")
heatmap_table <- rbind(heatmap_table, results[, c("Cell", "Study", ".y.", "p")])
stats_results_list[[col]]      <- results
data_stats_results_list[[col]] <- current_data
}
#test_cols <- colnames(data)[c(2, 3, 8, 10, 11, 12, 14, 16, 36, 37)]
test_cols <- colnames(data)[c(2, 3, 4, 9, 11, 12, 13, 15, 17, 37, 38)]
stats_results_list      <- list()
data_stats_results_list <- list()
heatmap_table           <- c()
for (col in test_cols){
formula_str <- paste0(col, " ~ DEG")
formula <- as.formula(formula_str)
print(col)
if (col == "HAR_Count" || col == "cHAR_Count" || col == "HAQER_Count" || col == "tandem_Count" || col == "dNdS" || col == "Alpha" || col == "specificity_values"){
print("A")
current_data <- na.omit(data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Cell_Region", "Region", "Expression")])
# Step 1: Calculate p-values for each group
results <- current_data %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}else{
if (col == "Human_hypo" || col == "Human_UP"){
reg_test_col <- "UR_test"
formula_str <- paste0(col, " ~ UR_test")
print("B1")
}else{
reg_test_col <- "DR_test"
formula_str <- paste0(col, " ~ DR_test")
print("B2")
}
formula <- as.formula(formula_str)
current_data <- data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Regulation", "Cell_Region", "Region", "Expression", reg_test_col)]
current_data <- current_data[!duplicated(current_data), ]
# Step 1: Calculate p-values for each group
results <- current_data          %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}
results <- results %>% mutate(Region = if_else(Study == "Caglayan", "PCC", "dlPFC"))
results$Cell_Region <- paste0(results$Cell, " ", results$Region)
# results <- results %>% add_xy_position(x = "Cell")
heatmap_table <- rbind(heatmap_table, results[, c("Cell", "Study", ".y.", "p.adj")])
stats_results_list[[col]]      <- results
data_stats_results_list[[col]] <- current_data
}
head(heatmap_table)
head(results)
#test_cols <- colnames(data)[c(2, 3, 8, 10, 11, 12, 14, 16, 36, 37)]
test_cols <- colnames(data)[c(2, 3, 4, 9, 11, 12, 13, 15, 17, 37, 38)]
stats_results_list      <- list()
data_stats_results_list <- list()
heatmap_table           <- c()
for (col in test_cols){
formula_str <- paste0(col, " ~ DEG")
formula <- as.formula(formula_str)
print(col)
if (col == "HAR_Count" || col == "cHAR_Count" || col == "HAQER_Count" || col == "tandem_Count" || col == "dNdS" || col == "Alpha" || col == "specificity_values"){
print("A")
current_data <- na.omit(data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Cell_Region", "Region", "Expression")])
# Step 1: Calculate p-values for each group
results <- current_data %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}else{
if (col == "Human_hypo" || col == "Human_UP"){
reg_test_col <- "UR_test"
formula_str <- paste0(col, " ~ UR_test")
print("B1")
}else{
reg_test_col <- "DR_test"
formula_str <- paste0(col, " ~ DR_test")
print("B2")
}
formula <- as.formula(formula_str)
current_data <- data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Regulation", "Cell_Region", "Region", "Expression", reg_test_col)]
current_data <- current_data[!duplicated(current_data), ]
# Step 1: Calculate p-values for each group
results <- current_data          %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}
results <- results %>% mutate(Region = if_else(Study == "Caglayan", "PCC", "dlPFC"))
results$Cell_Region <- paste0(results$Cell, " ", results$Region)
# results <- results %>% add_xy_position(x = "Cell")
heatmap_table <- rbind(heatmap_table, results[, c("Cell", "Study", ".y.", "p_adj")])
stats_results_list[[col]]      <- results
data_stats_results_list[[col]] <- current_data
}
saveRDS(heatmap_table, "../../Visualization_data/Figure 5/heatmap_table_HAQER.rds")
write_xlsx(heatmap_table, "../../Visualization_data/Figure 5/heatmap_table_HAQER.xlsx")
heatmap_table_plotting <- heatmap_table[heatmap_table$.y. != "specificity_values", ]
write_xlsx(heatmap_table_plotting, "../../Visualization_data/Figure 5/heatmap_table_for_plotting_HAQER.xlsx")
View(results)
source("../../Baseline/Figure 3 Baseline.R")
data     <- readRDS("../../Visualization_data/Figure 3/full_table_HAQER.rds")
data$DEG <- as.factor(data$DEG)
data
setwd("D:/Yi/Evolution Paper/Post processing runs/Visualization - cellbender processed data - 018/loci_overlap_calculator/5.Boxplot_visualization")
data     <- readRDS("Barplot_tables/bp_data_pvalues_all_considered_genes_V7.rds")
data$DEG <- as.factor(data$DEG)
data
data
setwd("D:/Yi/Evolution Paper/Post processing runs/Generate All Figures/Code/Figure 3")
data2     <- readRDS("../../Visualization_data/Figure 3/full_table_HAQER.rds")
data2
data2     <- readRDS("../../Visualization_data/Figure 3/full_table.rds")
data2
source("../../Baseline/Figure 3 Baseline.R")
data     <- readRDS("../../Visualization_data/Figure 3/full_table_HAQER.rds")
data$DEG <- as.factor(data$DEG)
#test_cols <- colnames(data)[c(2, 3, 8, 10, 11, 12, 14, 16, 36, 37)]
test_cols <- colnames(data)[c(2, 3, 4, 9, 11, 12, 13, 15, 17, 37, 38)]
stats_results_list      <- list()
data_stats_results_list <- list()
heatmap_table           <- c()
for (col in test_cols){
formula_str <- paste0(col, " ~ DEG")
formula <- as.formula(formula_str)
print(col)
if (col == "HAR_Count" || col == "cHAR_Count" || col == "HAQER_Count" || col == "tandem_Count" || col == "dNdS" || col == "Alpha" || col == "specificity_values"){
print("A")
current_data <- na.omit(data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Cell_Region", "Region", "Expression")])
# Step 1: Calculate p-values for each group
results <- current_data %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}else{
if (col == "Human_hypo" || col == "Human_UP"){
reg_test_col <- "UR_test"
formula_str <- paste0(col, " ~ UR_test")
print("B1")
}else{
reg_test_col <- "DR_test"
formula_str <- paste0(col, " ~ DR_test")
print("B2")
}
formula <- as.formula(formula_str)
current_data <- data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Regulation", "Cell_Region", "Region", "Expression", reg_test_col)]
current_data <- current_data[!duplicated(current_data), ]
# Step 1: Calculate p-values for each group
results <- current_data          %>%
group_by(Cell, Species, Study) %>%
wilcox_test(formula)
# Step 2: Apply FDR correction within each "Study" category
results <- results %>%
group_by(Study) %>%
mutate(p_adj = p.adjust(p, method = "fdr"))
# Step 3: Add significance labels based on the corrected p-values
results <- results %>%
add_significance("p_adj", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols = c("****", "***", "**", "*", "ns"))
# Un-group the results if needed
results <- results %>% ungroup()
}
results <- results %>% mutate(Region = if_else(Study == "Caglayan", "PCC", "dlPFC"))
results$Cell_Region <- paste0(results$Cell, " ", results$Region)
# results <- results %>% add_xy_position(x = "Cell")
heatmap_table <- rbind(heatmap_table, results[, c("Cell", "Study", ".y.", "p_adj")])
stats_results_list[[col]]      <- results
data_stats_results_list[[col]] <- current_data
}
data1     <- readRDS("../../Visualization_data/Figure 3/full_table_HAQER.rds")
data$DEG <- as.factor(data$DEG)
data2     <- readRDS("../../Visualization_data/Figure 3/full_table.rds")
data$DEG <- as.factor(data$DEG)
head(data1)
head(data2)
hist(data1$Human_hypo)
hist(data2$Human_hypo)
hist(data1$Human_hypo)
stats_results_list[["Human_hypo"]]
stats_results_list[["specificity_values"]]
stats_results_list[["dNdS"]]
data     <- readRDS("../../Visualization_data/Figure 3/full_table.rds")
head(data)
heatmap_table_HAQER <- readRDS("D:/Yi/Evolution Paper/Post processing runs/Visualization - cellbender processed data - 018/loci_overlap_calculator/5.Boxplot_visualization/heatmap_tables/heatmap_table_HAQER.rds")
heatmap_table_HAQER
setwd("D:/Yi/Evolution Paper/Post processing runs/Visualization - cellbender processed data - 018/loci_overlap_calculator/5.Boxplot_visualization")
source("../baseline_files/baseline_5_boxplot_data_prep.R")
data     <- readRDS("Barplot_tables/bp_data_pvalues_all_considered_genes_V7.rds")
data$DEG <- as.factor(data$DEG)
head(data)
data
setwd("D:/Yi/Evolution Paper/Post processing runs/Visualization - cellbender processed data - 018/loci_overlap_calculator/5.Boxplot_visualization")
source("../baseline_files/baseline_5_boxplot_data_prep.R")
data     <- readRDS("Barplot_tables/bp_data_pvalues_all_considered_genes_V7.rds")
data$DEG <- as.factor(data$DEG)
head(data)
setwd("D:/Yi/Evolution Paper/Post processing runs/Generate All Figures/Code/Figure 3")
source("../../Baseline/Figure 3 Baseline.R")
data     <- readRDS("../../Visualization_data/Figure 3/full_table_HAQER.rds")
data$DEG <- as.factor(data$DEG)
#test_cols <- colnames(data)[c(2, 3, 8, 10, 11, 12, 14, 16, 36, 37)]
test_cols <- colnames(data)[c(2, 3, 4, 9, 11, 12, 13, 15, 17, 37, 38)]
stats_results_list      <- list()
data_stats_results_list <- list()
heatmap_table           <- c()
for (col in test_cols){
formula_str <- paste0(col, " ~ DEG")
formula <- as.formula(formula_str)
print(col)
if (col == "HAR_Count" || col == "cHAR_Count" || col == "HAQER_Count" || col == "tandem_Count" || col == "dNdS" || col == "Alpha" || col == "specificity_values"){
print("A")
current_data <- na.omit(data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Cell_Region", "Region", "Expression")])
results   <- current_data                                        %>%
group_by(Cell, Species, Study)                      %>%
wilcox_test(formula)                                %>%
adjust_pvalue(method = "bonferroni")                %>%
add_significance("p", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols   = c("****", "***", "**", "*", "ns"))
}else{
if (col == "Human_hypo" || col == "Human_UP"){
reg_test_col <- "UR_test"
formula_str <- paste0(col, " ~ UR_test")
print("B1")
}else{
reg_test_col <- "DR_test"
formula_str <- paste0(col, " ~ DR_test")
print("B2")
}
formula <- as.formula(formula_str)
current_data <- data[, c("Gene", col, "Cell", "Species", "Study", "DEG", "Regulation", "Cell_Region", "Region", "Expression", reg_test_col)]
current_data <- current_data[!duplicated(current_data), ]
results   <- current_data                                        %>%
group_by(Cell, Species, Study)                      %>%
wilcox_test(formula)                                %>%
adjust_pvalue(method = "bonferroni")                %>%
add_significance("p", cutpoints = c(0, 1e-04, 0.001, 0.01, 0.05, 1),
symbols   = c("****", "***", "**", "*", "ns"))
}
results <- results %>% mutate(Region = if_else(Study == "Caglayan", "PCC", "dlPFC"))
results$Cell_Region <- paste0(results$Cell, " ", results$Region)
# results <- results %>% add_xy_position(x = "Cell")
heatmap_table <- rbind(heatmap_table, results[, c("Cell", "Study", ".y.", "p.adj")])
stats_results_list[[col]]      <- results
data_stats_results_list[[col]] <- current_data
}
stats_results_list[["dNdS"]]
data
data
saveRDS(heatmap_table, "../../Visualization_data/Figure 5/heatmap_table_HAQER_method2.rds")
write_xlsx(heatmap_table, "../../Visualization_data/Figure 5/heatmap_table_HAQER_method2.xlsx")
heatmap_table_plotting <- heatmap_table[heatmap_table$.y. != "specificity_values", ]
write_xlsx(heatmap_table_plotting, "../../Visualization_data/Figure 5/heatmap_table_for_plotting_HAQER_method2.xlsx")
