source("../../Baseline/Figure S1-S3 Baseline.R")
all_counts <- readRDS("../../Visualization_data/Figure S1-S3/combined_S123.rds")
setwd("D:/Yi/Evolution Paper/Post processing runs/Generate All Figures/Code/Figure S1-S3")
current_counts
current_counts <- all_counts[all_counts$Study == study, ]
p     <- list()
count <- 1
for (study in studies){
all_counts <- c()
current_counts <- all_counts[all_counts$Study == study, ]
p[[count]] <- ggplot(current_counts, aes(CellType, fill = Spec_Reg))                                                           +
geom_bar(data = current_counts,
aes(y = Number), stat = "identity",
position = "dodge", width = geom_bar_width, alpha=geom_bar_alpha, color = "black")              +
scale_fill_manual(values=list( "#0fbabd", "#bc131f", "#21675e", "#8c1044"))                              +
#geom_text(aes(label=Study, x = 1, y = 4), position=position_dodge(width=0.9), vjust=-1.0, size=5)           +
geom_hline(yintercept = 0,colour = "black")                                             +
ylim(c(-3,  4.5)) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x=element_text(size=16, angle = 45, vjust = 1, hjust = 1),
axis.text=element_text(size=16)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10), drop = FALSE)+
xlab("Cell Type")
count <- count + 1
}
current_counts
all_counts
current_counts <- all_counts[all_counts$Study == study, ]
source("../../Baseline/Figure S1-S3 Baseline.R")
all_counts <- readRDS("../../Visualization_data/Figure S1-S3/combined_S123.rds")
p     <- list()
count <- 1
for (study in study_results){
current_counts <- all_counts[all_counts$Study == study, ]
p[[count]] <- ggplot(current_counts, aes(CellType, fill = Spec_Reg))                                                           +
geom_bar(data = current_counts,
aes(y = Number), stat = "identity",
position = "dodge", width = geom_bar_width, alpha=geom_bar_alpha, color = "black")              +
scale_fill_manual(values=list( "#0fbabd", "#bc131f", "#21675e", "#8c1044"))                              +
#geom_text(aes(label=Study, x = 1, y = 4), position=position_dodge(width=0.9), vjust=-1.0, size=5)           +
geom_hline(yintercept = 0,colour = "black")                                             +
ylim(c(-3,  4.5)) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x=element_text(size=16, angle = 45, vjust = 1, hjust = 1),
axis.text=element_text(size=16)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10), drop = FALSE)+
xlab("Cell Type")
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=2, ncol = 1, common.legend = TRUE, legend="bottom")
current_counts
current_counts$Cell
p     <- list()
count <- 1
for (study in study_results){
current_counts <- all_counts[all_counts$Study == study, ]
p[[count]] <- ggplot(current_counts, aes(Cell, fill = Spec_Reg))                                                           +
geom_bar(data = current_counts,
aes(y = Number), stat = "identity",
position = "dodge", width = geom_bar_width, alpha=geom_bar_alpha, color = "black")              +
scale_fill_manual(values=list( "#0fbabd", "#bc131f", "#21675e", "#8c1044"))                              +
#geom_text(aes(label=Study, x = 1, y = 4), position=position_dodge(width=0.9), vjust=-1.0, size=5)           +
geom_hline(yintercept = 0,colour = "black")                                             +
ylim(c(-3,  5.0)) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x=element_text(size=16, angle = 45, vjust = 1, hjust = 1),
axis.text=element_text(size=16)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10), drop = FALSE)+
xlab("Cell Type")
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=2, ncol = 1, common.legend = TRUE, legend="bottom")
ggsave(filename = paste0(figure_output_path, study, "_Figure_1.jpg"), plot = g, device = "jpeg",
width=8.5, height=11, dpi=300)
p     <- list()
count <- 1
for (study in study_results){
current_counts <- all_counts[all_counts$Study == study, ]
p[[count]] <- ggplot(current_counts, aes(Cell, fill = Spec_Reg))                                                           +
geom_bar(data = current_counts,
aes(y = Number), stat = "identity",
position = "dodge", width = geom_bar_width, alpha=geom_bar_alpha, color = "black")              +
scale_fill_manual(values=list( "#0fbabd", "#bc131f", "#21675e", "#8c1044"))                              +
#geom_text(aes(label=Study, x = 1, y = 4), position=position_dodge(width=0.9), vjust=-1.0, size=5)           +
geom_hline(yintercept = 0,colour = "black")                                             +
ylim(c(-3,  5.0)) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x=element_text(size=16, angle = 45, vjust = 1, hjust = 1),
axis.text=element_text(size=16)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10), drop = FALSE)+
xlab("Cell Type")
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=3, ncol = 1, common.legend = TRUE, legend="bottom")
ggsave(filename = paste0(figure_output_path, study, "_Figure_1.jpg"), plot = g, device = "jpeg",
width=8.5, height=11, dpi=300)
source("../../Baseline/Figure S1-S3 Baseline.R")
all_counts <- readRDS("../../Visualization_data/Figure S1-S3/combined_S123.rds")
p     <- list()
count <- 1
for (study in study_results){
current_counts <- all_counts[all_counts$Study == study, ]
p[[count]] <- ggplot(current_counts, aes(Cell, fill = Spec_Reg))                                                           +
geom_bar(data = current_counts,
aes(y = Number), stat = "identity",
position = "dodge", width = geom_bar_width, alpha=geom_bar_alpha, color = "black")              +
scale_fill_manual(values=list( "#0fbabd", "#bc131f", "#21675e", "#8c1044"))                              +
#geom_text(aes(label=Study, x = 1, y = 4), position=position_dodge(width=0.9), vjust=-1.0, size=5)           +
geom_hline(yintercept = 0,colour = "black")                                             +
ylim(c(-5,  5.0)) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x=element_text(size=16, angle = 45, vjust = 1, hjust = 1),
axis.text=element_text(size=16)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10), drop = FALSE)+
xlab("Cell Type")
count <- count + 1
}
g <- ggarrange(plotlist = p, nrow=3, ncol = 1, common.legend = TRUE, legend="bottom")
ggsave(filename = paste0(figure_output_path, study, "_Figure_1.jpg"), plot = g, device = "jpeg",
width=8.5, height=11, dpi=300)
