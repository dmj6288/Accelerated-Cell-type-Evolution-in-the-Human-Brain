#!/bin/bash -l

#SBATCH -N 1 --ntasks-per-node=6 --partition=gpu
#SBATCH --gres=gpu:1
#SBATCH --job-name="PAIR"
#SBATCH --output=/home/dennis00/Yi_lab/CellBender_scripts/slurm-archive/%j.out

module load cuda/11.7

cd $SLURM_SUBMIT_DIR

cd /home/dennis00/Yi_lab/CellBender_scripts

REPS="HSB106 HSB628 HSB189 HSB340"

for p in $REPS
do
	for i in {1..2}
	do
	folder_name="${p}_${i}"
	echo $folder_name
		  cellbender remove-background \
                  	--input "/home/dennis00/Yi_lab/Ma_h5/${folder_name}.h5" \
                  	--output "/home/dennis00/Yi_lab/cellbent_output_RAW/${folder_name}.h5" \
                  	--cuda \
                   	--expected-cells 25000 \
                  	--total-droplets-included 40000 \
                 	--low-count-threshold 15 \
                  	--learning-rate 1e-4 \
                  	--fpr 0.01 \
                 	--epochs 150

		echo $i
	done
done

echo cellbender_Ma_human
echo "SLURM Job ID        : ${SLURM_JOB_ID}"
