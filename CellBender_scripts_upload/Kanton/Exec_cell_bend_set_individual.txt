#!/bin/bash -l

#SBATCH -N 1 --ntasks-per-node=6 --partition=gpu
#SBATCH --gres=gpu:1
#SBATCH --job-name="PAIR"
#SBATCH --output=/home/dennis00/Yi_lab/CellBender_scripts/slurm-archive/%j.out

module load cuda/11.7

cd $SLURM_SUBMIT_DIR

cd /home/dennis00/Yi_lab/CellBender_scripts/Kanton

FILES="3 BA1 CHD2"

for FILE in $FILES
	do
		cellbender remove-background \
                  	--input "/home/dennis00/Yi_lab/raw_h5_data/Kanton_h5/set_$FILE.h5" \
                  	--output "/home/dennis00/Yi_lab/cellbent_output_RAW/Kanton/set_$FILE.h5" \
                  	--cuda \
                   	--expected-cells 10000 \
                  	--total-droplets-included 15000 \
                 	--low-count-threshold 15 \
                  	--learning-rate 1e-4 \
                  	--fpr 0.01 \
                 	--epochs 150
	done
echo cellbender_Kanton_set_1
echo "SLURM Job ID        : ${SLURM_JOB_ID}"
